(function(n){typeof define=="function"&&define.amd?define(["jquery"],n):n(jQuery)})(function(n){var i=n.fn.tree,t=function(t,i){this.$element=n(t);this.options=n.extend({},n.fn.tree.defaults,i);this.$element.on("click.fu.tree",".tree-item",n.proxy(function(n){this.selectItem(n.currentTarget)},this));this.$element.on("click.fu.tree",".tree-branch-header",n.proxy(function(n){this.openFolder(n.currentTarget)},this));this.render()};t.prototype={constructor:t,destroy:function(){return this.$element.find("li:not([data-template])").remove(),this.$element.remove(),this.$element[0].outerHTML},render:function(){this.populate(this.$element)},populate:function(t){var i=this,r=t.hasClass("tree")?t:t.parent(),u=r.find(".tree-loader:eq(0)"),f=r.data();u.removeClass("hide");this.options.dataSource(f?f:{},function(f){u.addClass("hide");n.each(f.data,function(u,f){var e,o,s;f.type==="folder"?(e=i.$element.find("[data-template=treebranch]:eq(0)").clone().removeClass("hide").removeAttr("data-template"),e.data(f),e.find(".tree-branch-name > .tree-label").html(f.text||f.name),o=e.find(".tree-branch-header"),"icon-class"in f&&o.find("i").addClass(f["icon-class"]),"additionalParameters"in f&&"item-selected"in f.additionalParameters&&f.additionalParameters["item-selected"]==!0&&setTimeout(function(){o.trigger("click")},0)):f.type==="item"&&(e=i.$element.find("[data-template=treeitem]:eq(0)").clone().removeClass("hide").removeAttr("data-template"),e.find(".tree-item-name > .tree-label").html(f.text||f.name),e.data(f),"additionalParameters"in f&&"item-selected"in f.additionalParameters&&f.additionalParameters["item-selected"]==!0&&(e.addClass("tree-selected"),e.find("i").removeClass(i.options["unselected-icon"]).addClass(i.options["selected-icon"])));s=f.attr||f.dataAttributes||[];n.each(s,function(n,t){switch(n){case"cssClass":case"class":case"className":e.addClass(t);break;case"data-icon":e.find(".icon-item").removeClass().addClass("icon-item "+t);e.attr(n,t);break;case"id":e.attr(n,t);e.attr("aria-labelledby",t+"-label");e.find(".tree-branch-name > .tree-label").attr("id",t+"-label");break;default:e.attr(n,t)}});t.hasClass("tree-branch-header")?r.find(".tree-branch-children:eq(0)").append(e):t.append(e)});i.$element.trigger("loaded.fu.tree",r)})},selectItem:function(t){var f;if(this.options.selectable!=!1){var i=n(t),e=i.data(),o=this.$element.find(".tree-selected"),u=[],r=i.find(".icon-item");this.options.multiSelect?n.each(o,function(t,r){var f=n(r);f[0]!==i[0]&&u.push(n(r).data())}):o[0]!==i[0]&&(o.removeClass("tree-selected").find("i").removeClass(this.options["selected-icon"]).addClass(this.options["unselected-icon"]),u.push(e));f="selected";i.hasClass("tree-selected")?(f="deselected",i.removeClass("tree-selected"),(r.hasClass(this.options["selected-icon"])||r.hasClass(this.options["unselected-icon"]))&&r.removeClass(this.options["selected-icon"]).addClass(this.options["unselected-icon"])):(i.addClass("tree-selected"),(r.hasClass(this.options["selected-icon"])||r.hasClass(this.options["unselected-icon"]))&&r.removeClass(this.options["unselected-icon"]).addClass(this.options["selected-icon"]),this.options.multiSelect&&u.push(e));this.$element.trigger(f+".fu.tree",{target:e,selected:u});i.trigger("updated.fu.tree",{selected:u,item:i,eventType:f})}},openFolder:function(t){var f=n(t),i,r,u,e,o,s;i=f.closest(".tree-branch");r=i.find(".tree-branch-children");u=r.eq(0);f.find("."+n.trim(this.options["close-icon"].replace(/(\s+)/g,"."))).length?(e="opened",o=this.options["close-icon"],s=this.options["open-icon"],i.addClass("tree-open"),i.attr("aria-expanded","true"),u.removeClass("hide"),r.children().length||this.populate(r)):f.find("."+n.trim(this.options["open-icon"].replace(/(\s+)/g,".")))&&(e="closed",o=this.options["open-icon"],s=this.options["close-icon"],i.removeClass("tree-open"),i.attr("aria-expanded","false"),u.addClass("hide"),this.options.cacheItems||u.empty());i.find("> .tree-branch-header .icon-folder").eq(0).removeClass(o).addClass(s);this.$element.trigger(e+".fu.tree",i.data())},selectFolder:function(t){var i=n(t),r=i.closest(".tree-branch"),u=this.$element.find(".tree-branch.tree-selected"),o=r.data(),f=[],e="selected";r.hasClass("tree-selected")?(e="deselected",r.removeClass("tree-selected")):r.addClass("tree-selected");this.options.multiSelect?(u=this.$element.find(".tree-branch.tree-selected"),n.each(u,function(t,r){var u=n(r);u[0]!==i[0]&&f.push(n(r).data())})):u[0]!==i[0]&&(u.removeClass("tree-selected"),f.push(o));this.$element.trigger(e+".fu.tree",{target:o,selected:f});i.trigger("updated.fu.tree",{selected:f,item:i,eventType:e})},selectedItems:function(){var i=this.$element.find(".tree-selected"),t=[];return n.each(i,function(i,r){t.push(n(r).data())}),t},collapse:function(){var t=this.options.cacheItems;this.$element.find("."+n.trim(this.options["open-icon"].replace(/(\s+)/g,"."))).each(function(){var r=n(this).removeClass(this.options["open-icon"]+" "+this.options["close-icon"]).addClass(this.options["close-icon"]),u=r.parent().parent(),i=u.children(".tree-branch-children");i.addClass("hide");t||i.empty()})}};n.fn.tree=function(i){var u=Array.prototype.slice.call(arguments,1),r,f=this.each(function(){var e=n(this),f=e.data("fu.tree"),o=typeof i=="object"&&i;f||e.data("fu.tree",f=new t(this,o));typeof i=="string"&&(r=f[i].apply(f,u))});return r===undefined?f:r};n.fn.tree.defaults={dataSource:function(){},multiSelect:!1,cacheItems:!0,folderSelect:!1};n.fn.tree.Constructor=t;n.fn.tree.noConflict=function(){return n.fn.tree=i,this}});
//# sourceMappingURL=fuelux.tree.min.js.map
